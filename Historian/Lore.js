var lore = {
	loreTree:
	{
		Logbook:
		{
			"Spring, 363":
			{
				"10th Day":
				{
					text: "I began my preparations again. I did not expect that old man—who I suspect to be the real Alchemist—to be this hostile and deadly. I need to be much more careful and create defensive measures to protect myself. I doubt he will miss his mark next time. | | I still don’t know why I didn’t find any information about the Golems, let alone their advanced versions. The original Golems I discovered represented all 4 Elements known to Elementalism, so what were those combined ones? | | | Why are public books so inaccurate compared to what I was seeing? Well, it’s something I’ll need to investigate in the future. For now, I need to find a new place for my experiments.",
				},
				"14th Day":
				{
					text: "The Globe in my shoulder changed me drastically. Not only can I do any manual task I’ve done before with ease, but I no longer feel tired or hungry. I’m not sure what happened, so I still try to eat something each day just to be safe. If this is my brain malfunctioning, I would rather not collapse in some lonely place. | | More importantly, I can now ‘feel’ elements. If I focus, I can see how Fire flows above lanterns, how Earth shifts slightly in the ground beneath my feet, and so on. I can also control Elements much more precisely, and on a much larger scale than before. | | I decide to create my own laboratory outside the city; it should be easy to dig out and fortify an underground base."
				},
				"26th Day":
				{
					text: "I lost consciousness while manipulating the Earth inside the rocks of my soon-to-be base. I woke up 2 days later, without even a slight feeling of what was wrong. I think my mind just shut off after working for a week or so. I’ll try to take a break every day or so to calm down and simulate sleep. Hopefully, that’ll be enough."
				},
				"71th Day":
				{
					lock: ["machineEarth", 0],
					text: "Finally, the space for my experiments is ready. It was harder than I thought it would be, but I had big requirements this time around. A circular underground room with a diameter of 50 meters and height of 4 meters, located far beneath the ground. Several small connected rooms, everything lit up with delicate Firelights. Along the outside, rocks have been remodeled into long and sturdy poles, holding the entire structure steady. My durability testing included detonating small explosives in a couple of locations at once. While they left small holes in the walls they were fixed to, the entire structure didn’t even shift. I’m going back to the city to gather machine parts. Instead of masking the entrance stairwell, I’ll simply move terrain around to bury it."
				},
				"73rd Day":
				{
					lock: ["machineEarth", 0],
					text: "I’ve disguised my arms with a long coat because I don’t want to create weird rumors. Though I have to say, I felt strangely disconnected from the people I was doing business with; however, feeling worried about what’s happened to me won’t change anything. I can only move forward. | | There is a bigger problem though. I ran out of funds while buying all the metal parts and glass components. It should be enough for the few machines I’m going to start with, as well as my security measures, but in order to expand beyond that, I’ll need to come up with some products I could sell. Even though Elementalism is looked down upon for being very cost-inefficient, maybe I’ll be able to figure out something profitable thanks to the precision of my control over the Elements."
				},
				"79th Day":
				{
					lock: ["machineEarth", 0],
					text: "My materials only allowed me to prepare the original 4 machines. But my new perception allowed me to understand how the catalyst crystal worked and incorporate the design into each machine. | | I was thinking about how the Alchemist entered my workshop last time—it really was something out of the ordinary. It was something like a portal appearing on the wall. I don’t have much to work with here, but I think it’s safe to assume it’s something based on the Elements, like my rifts. If that’s the case, then maybe if I throw different Elements the next time the portal emerges it’ll collapse and disappear. I have a few ideas on how could I achieve that."
				},
			},
			"Summer, 363":
			{
				"7th Day":
				{
					lock: ["machineWater", 1],
					text: "I’ve embedded multiple storage pipes into a wall, each filled with one of the Elements. In case of danger, they’ll cause a chain reaction and clear the entire area out of every bit of the Elements. | | I’ve also started preparing Fire lanterns for sale. Next on the shopping list: More machine parts and maybe some weapons for self-defense."
				},
				"20th Day":
				{
					lock: ["machineWater", 1],
					text: "The workshop is ready. With some spare parts and a feeling of moderate safety, I’m going to go for it and start running machines. To minimize the danger of attracting the Alchemist again, I’ll only use processes with controllable or small outputs."
				},
				"21st Day":
				{
					lock: ["machineEarth", 1],
					text: "I’m ready to recreate the Golems. The last time I tried making a few of the same type, it resulted in a complete waste of resources, but now I have a good plan on how to hold them still. I’ll open a small rift between the pedestals and it should jam the attractive force between the Golems. I’ve devised a special chamber that doesn’t isolate but redirect the Elemental waves into the ground. Finally, their creation won’t waste my resources as much. | | The next goal is automating the process of moving and merging the golems."
				},
				"23rd Day":
				{
					lock: ["golemMerger", 0],
					text: "I let my first pair of Golem merge today, but the resulting Mud Golem collapsed immediately. I can only suspect that it’s the Alchemist's doing after the Infernal Golem incident. It took a couple of seconds to disappear completely, so maybe I could try reaching into the broken Golem with my Glove and pull out whatever is inside. | | Yes! It was a huge success. Not only did I manage to pull in a bit of Mud Element, but I also understand the nature of Golems much better. Simply put, it’s like just my rifts—a connection to the source of its Element. I don’t think I could replicate it in any other way than imploding a compression crystal inside the orb. | | Now… I’m not sure why something like a Mud Element even exists. Elementalism was supposed to use only 4 Elements. Yes, it was hard getting it, but I think books on the subject would mention the existence of other types… Something about this definitely feels strange."
				},
				"36th Day":
				{
					lock: ["golemMerger", 1],
					text: "After going to town to sell some of my lanterns, I was able to buy many more machine parts. With the rest of the money, I bought some explosives and a simple rifle. I’ll need to practice shooting in my free time, after all, the last time I was shooting anything like that was during my years studying under my master. | | Now it’s time to set everything up for new machines. Let’s see how far can we go with the new Elements I discovered. Sadly I wasn’t able to extract Inferno out of Infernal Golem. For some unknown reason, when I pulled from it, nothing happened. I’ll need to investigate it later. At the moment though, I’ll start gathering more of the advanced Elements I can extract out of the Golems, and design some conversions based on similarities between them."
				},
				"44th Day":
				{
					lock: ["machineWater", 2],
					text: "Every machine is running in a very controlled and stable manner. Although getting more of the advanced Elements still is quite a chore, I tested out a new conversion of base Elements. It’ll require a peculiar setup, allowing advanced Elements to flow around the basic machines. This will induce a much more powerful conversion but thankfully won’t use up advanced Elements at all. | | Today I realized once again that I totally forgot about eating food. I’ll need to go to the city soon to stock on some supplies. Since my machines can pretty much work fine on their own, I have a big enough supply of Air to create some floating bowls. They usually fetch quite a good price on the market, so I’ve decided that they’ll be my source of money for the time being."
				},
				"46th Day":
				{
					lock: ["machineWater", 2],
					text: "I’m going to the city for a couple of days. I’ll leave machines running while I’m gone. The assimilation process is taking its sweet time, I hope it’ll be done by the time I’m back."
				},
				"Encounter":
				{
					lock: ["machineWater", 2],
					text: "When I came back I saw a womanly figure crouching next to the Aggregator and staring intensely inside it. Immediately, I quietly stepped back, put down the box that I was carrying and readied my rifle. I came back into the room, aiming at her, and yelled:\“Who are you and what are you doing here\!\?\” | | Her name is Opal. Thankfully, she was quite peaceful, and after quite a long talk she simply left. Huh, I guess I really grew weary of people. Anyway, I learned quite a bit about the Alchemist from her. Apparently, he studied Elementalism, and he got so deep into the research that it changed him permanently. Now he has a split personality, and if he doesn’t focus, his behavior changes based on the Elements channeling through him. And, of course, he tries to stop everybody from pursuing knowledge in this subject. That’s why the whole art is in recession. | | Before leaving, Opal told me that she will be back with some of her friends in a few weeks and that they will help me against the Alchemist. It sounded like they had created a guerilla force opposing him. I decided that we will meet in a remote location and then I’ll decide if we can agree to work together."
				},
				"Aftermath":
				{
					lock: ["machineWater", 2],
					text: "Was I bit too trusting? Well, at least she didn’t try to kill me on a spot, and she seemed really interested in my research. I couldn’t help but notice that she was looking at me with nearly the same intensity as she was looking at my machines before. | | But how did she find this place? It’s not that the entrance was masked perfectly, it literally wasn’t there! I’m sealing it off with a good amount of ground and rocks, and when I came back it looked exactly as I left it. I think I’ll make some small safes in a few places around the city to hide some money and supplies. At least I won’t be starting from nothing again, in case something happens to my base."
				},
			},
			"Summer, 363.":
			{
				"52nd Day":
				{
					lock: ["machineVoid", 0],
					text: "I went back to work after Opal’s departure. While I couldn’t focus on it for a couple of hours, I had a flash of inspiration and made a breakthrough. I misunderstood how the Infernal Golem worked, and why I couldn’t get traces of Air and Fire combination. It’s not that the merge was not creating anything, but it’s more that it was creating ‘nothing’, the actual element of nothingness. I decided to call it Void and after a few tests, I found that standard methods of getting it aren't effective. | | To get it I devised another method, clashing opposite advanced Elements and letting them annihilate themselves lets me pull out a tiny amount of Void for use in my machines. As an added bonus, I can pull a bit of Mud from the creation of Void which is the Elemental opposite of Void. Maybe it’ll recuperate a bit of the cost."
				},
				"53th Day":
				{
					lock: ["machineNexus", 0],
					text: "Not only did the new method work flawlessly in the automated scenario, but it also let me test out properties of newly discovered Element. Most important of those is the massive suction force. Naturally, that force causes surrounding matter and Elements to fly into bits of Void, annihilating it instantly. That’s why I had so much trouble getting it in the first place, to control Void I needed to create a near-perfect vacuum inside Orb. | | When I thought about Void for a second I remembered my original goal, that was connecting four different Elements together. I wonder if I can put a bit of Goal between them to siphon them into a small area while Void takes the first brunt of destructive interactions. | | I kinda didn’t expect it to work. But it did, although faulty. It created some sort of purple substance. But there was so little of it, I almost couldn’t see it, but it quickly increased its volume, filling the test tube in a flash and then disappeared. For the second test, following my troubles with Void, I created a vacuum in the Orb and did the test there again. It didn’t grow this time, so I guess it was ‘eating’ everything nearby to grow. But problems did not end there - I couldn’t manipulate it at all, even though my control abilities improved a lot since I started my research. When I attempted to affect it just moved towards me forcibly, touched the border of Orb, ‘ate’ it and evaporated soon after. | | Couple tests later I decided how I will call it. Alkahest. In legends, it could dissolve anything. My substance of it can absorb anything it touches, so it’s close enough I’d say. After direct contact though it expands until hitting critical point after which it disappears. I’m unable to manipulate it using standard methods, but my subspace transportation system does it safely. I kinda feel that substance itself is quite dangerous if left unattended, I will need to work on extreme safety methods to deal with it. At this point, I cannot create a lot of it, so it won’t cause too many troubles even if something breaks. But still, I need to be cautious about Alkahest. Is it the be-all-end-all of Elementalism? And so I’m going back to the study table."
				},
				"60th Day":
				{
					lock: ["machineNexus", 1],
					text: "With new Elements working their way into my machines I was able to improve few processes, and re-envision golem containment. I created a big globe inside a slightly smaller one and filled the space in between with Void. This caused a middle one to float inside in perfect centrum of the bigger globe, and Void acts as an isolating barrier between inside and outside. Moreover, the pulling force caused by the Void even holds contents of the middle orb in the middle. This creation was invaluable in safely storing Alkahest while keeping its devouring tendency in check., but it also acts as a very good jammer for golems. So I could increase amounts of golems I could hold at the same time. Also, I increased the number of golems created at the same time, nothing was stopping me mass producing them anymore. | | I checking up on infuser to see if everything there was proceeding smoothly when a bright light caught my eye far opposite of the wall. There were cracks emitting light, slowly expanding from a central point. That light reminded me of one specific monster, who apparently noticed me even though my experiments were really low scale and done behind the barrier-like structure. I grabbed my rifle, which I lay down a couple of feet away while I was checking on Infuser, quickly armed it and looked up again. There He was, forcefully widening the gap between pipes with his hands coated in Earth. While the gap was only so big to show his hands and part of his torso there couldn’t be any mistake about his identity. Alchemist came to me again. I don’t think he saw me at that point, so I felt that I had an upper hand this time. I grabbed one of the metal rods I had spread around the ground and thrust it in the ground, and opened a small rift at the end, inside one of the pipes that were buried all around my base. The reaction was nearly instant, a small wave broke the pipe, flowing outwards, colliding with other pipes and causing them to collapse into their own, separate waves. Chain reaction spread below me, going faster and faster, and then waves started to sink through the surface to the room. I aimed rifle in the meantime, and, stilling my breath, shot at Alchemist. But it didn’t even reach him. Bullet stopped a few inches away from him and dissolved into a colorful lump of Elements before annihilation caused it to cease its existence. At that point, chained wave reaction hit me with a full force, as more than 60% of base’s surface pipes exploded already. | | I felt like a rock, I couldn’t move properly anymore. Rifle dropped from my paralyzed hands and I could only watch from now on. A sense of dread filled me, Alchemist stepped through the gap and looked around with complicated expression, but he stopped when he got hit by the first mixed wave of Elements. Bright light around him dimmed and he started to look down, his eyes widened when he realized what’s happening. He turned around and jumped through the gap in the barrier, while the main wavefront was getting nearer and nearer. After leaving the perimeter light grew a bit brighter, and soon after it disappeared. I guess he used his portal ability again. | | A few minutes later barrier was fully undone, and waves flew away. Soon after I recovered my ability to move, although I still felt sluggish. My first encounter with Alchemist that I could call my victory. Even though it was a bitter one. The rifle was a complete waste of time and money, my barrier is shredded to pieces and I don’t know why it caused me to lose my ability to move. I don’t have time to ponder, I need to set up a barrier as soon as possible in case he comes back soon. And I need to improve it further, it worked, but I can make it stronger and faster. Making a surprise attack like that won’t be easy next time."
				},
				"61th Day":
				{
					lock: ["machineNexus", 1],
					text: "I recovered most of my movement ability and put together a makeshift barrier. Using remains of pipes in the ground and few spare sheets of metal I remade them and filled with Elements. My machines were unaffected by all of those waves going around thanks to Void coating absorbing and deflecting all outside forces. | | I think biggest improvement I thought about will be making couple more of layers of the barrier, and then couple loose barriers that will let Alchemist through, but I’ll close them up somehow to lock him inside. It seemed like he couldn’t portal out from the inside, so barrier must somehow disturb that ability. Back to work."
				},
				"62nd Day":
				{
					lock: ["Alkahest", 42],
					text: "While I was making a new barrier, my machines were steadily producing more and more Elements. The Void recipe got to quite a high level of efficiency thanks to the improved structure and bigger amounts processed. With more Void at hand, I was able to increase the volume of Alkahest produced. I wanted to test it out in bigger volume, but when its amount reached 42 units it destabilized. It seems that coating failed to contain the volatile contents in stasis, and Alkahest devoured the Orb it was in along with the coating. Dissolved Void gave the substance pulling properties, so it floated mid-air without eating rest of machine. Even though it wasn’t expanding anymore, it started sending small waves around. I guess that new property is caused by the increased volume of the substance. | | A few minutes later waves stopped appearing, and soon after Alkahest jumped towards each machine in its vicinity devouring every bit of Elements I had stored there. It also jumped towards me and clung to the globe on my left shoulder. Suddenly my arm fell down, dangling and I couldn’t move it. I saw Alkahest in each Orb disappear after a second, leaving all machines intact but empty. And then I felt that globe in my shoulder collapsed, and with it, my consciousness left me."
				},
				"63rd Day":
				{
					lock: ["Alkahest", 42],
					text: "I realized I was awake. After standing up I looked around, and everything was how I saw it before sleeping. Empty machines, ready to work. I was feeling good, looking at myself I couldn’t find the globe, it seems like it vanished completely. I decided that worrying about myself will only stop me from progress, and I felt like I’m at the doorstep before greatness. I knew exactly what I had to do. Triggering machines to work again, I knew I always had to have a bit of Alkahest at hand to work as a catalyst. I felt like that sleep I had unlocked some sort of hidden box in my mind, and I started untangling streams of information coming from there. Soon after I discovered that Elements are much more complicated than I could ever imagine before. And with a satisfying smile, I started construction of machines for the third tier of Elements."
				},
				"76th Day":
				{
					lock: ["machineCryogen", 0],
					text: "I felt a presence of Opal again, but she didn’t enter the structure, just found the entrance and after a couple of seconds simply left, probably leaving the note there somewhere. I know that I said to do this way, and organize meeting nearby, but to be honest I couldn’t be bothered to do it anymore. The knowledge I have cannot wait, I want to study it more. Every day I’m making one or two breakthroughs, making new machines, discovering different realms of Elements I can interact with using my rifts. There is so much more to discover..."
				},
				"88th Day":
				{
					lock: ["machineGold", 0],
					text: "Rate of progress declined slowly. Most processes that I find usable are generally not really efficient due to how difficult accessing the third tier of rifts is, and I kinda ran out of hands. As always fine-tuning and manually controlling recipe in a machine or two leads to best results, but I cannot do that when I can’t even reach all of my machines with my Glove’s range. | | Why did I space them out so much? Ah, yes, I wanted to build up new machines outside of Alkahest’s influence range. This way reaching a critical amount of it won’t set me back too much, only requiring more basic Elements to regenerate. Sadly modifying positions of central machines proved impossible, I cannot reliably reproduce their recipes when they are spaced too far out of each other. | | My own status is… well, weird at best. I don’t feel that anything’s wrong in particular, but I cannot make myself go outside. My ‘sleep’ breaks also are getting harder each day, I feel restless and my mind is bouncing between multiple ideas and topic all the time. "
				},
				"89th Day":
				{
					lock: ["machineKnowledge", 1],
					text: "Few people came into my base today. While I felt slightly annoyed that they make me stop my work for a bit, I didn’t feel any hostility towards them. It’s not like they could do anything to my machines after all my recent improvements, and even if they managed to break something I could attack them with couple nasty Elements. Mostly Alkahest would be deadly, devouring bigger part of their body before disappearing. On a side note, I’ve perfected void coating to the point that it repels all matter. | | Anyway, the people that came in were indeed Opal and two men. I tried to greet them, but they ignored me completely! They looked around for a second and stopped a few steps from the entrance with mortified expressions. Opal crouched near something, and one man, through his Glove, checked out the surrounding Elements and their flow. At that point, he looked back at them, moving his mouth without a sound. Is he a mute? And why was he so pale? After getting attention from the others he pointed at me. Others also activated their Gloves. Wait, since when can I notice things like that? Opal stood up, looked at me and looked back down at the ground. She also opened her mouth but nothing was said. I kinda started to freak out a little, maybe I got deaf after the most recent accident? | | Few seconds have passed, and I didn’t know what to do, so I just did nothing. Opal and her buddies started to talk between each other, or at least I think that they did, I still couldn’t hear anything. At last the man who noticed me first closed his eyes and the Air around him formed into words:{ I’m Morgun. Nod if you can see this. }. I felt kinda sorry for him looking at it, clearly, he was going against the natural flow of Air, so letters were shaking a little. Or maybe one of my machines was working in an adjacent room and it was messing with him a little? Anyway, to show that I appreciate his efforts I simply nodded. | | Few yes/no questions later I got bored and just constructed my response to their next question using readily accessible Elements, ensuring that it would not collide with flows for a couple of minutes, and finishing it with { I have work to do, you are free to do whatever you want as long as you don’t interfere with my machines. }. After that, I went to the next room to do a bit more research. I felt that a few minutes later they left the base."
				},
				"90th Day":
				{
					lock: ["machineSilver", 0],
					text: "I decided to end spending my time on writing log. I’ll make notes about new additions to my machinery in separate study book, but writing this keeps me unnecessarily away. My habit of writing all important events that happened during my experiments was something I’ll remember fondly, but there are more important tasks at my base, and so much to do in different places that I need to cut down on other activities. | | | | To be continued."
				},
			}
		},
		Records:
		{
			"The Past":
			{
				"Stage One":
				{
					text: "Our protagonist with a tragic backstory delved into the art of Elementalism. He taught himself with nothing but a few books on the topic and some old tools; this leads him to the discovery of Golems. After touching all four Golems at once, he found himself in a space filled with bright light. But after seeing the silhouette of an old man, he got kicked out. That brief encounter removed him from the world for 7 months. After regaining consciousness, the protagonist was left with nothing but one goal - getting back to that place and finding out what really happened. | | The Elemental Glove he used during that period has permanently fused with his right arm.",
				},
				"Stage Two":
				{
					text: "With much better equipment, and his arm’s new ability to open small rifts that ‘produced’ Elements, our protagonist began experimenting once again. Trying to recreate the Golems lead to him suddenly discovering Merged Golems. He called one of them ‘Infernal’ and, by feeding it with Elements, caused the Infernal Golem to become sentient. However, the old man intervened and, with a sad look on his face, tried to kill our protagonist, before disappearing again. | | Our protagonist should have been disintegrated, but Infernal saved him by impaling him into the wreckage of his machines. A few hours later, he woke up feeling better than ever and discovered another change to his body. A glass globe, the remains of Infernal, was embedded into his left shoulder.",
				},
			},
			"Opal":
			{
				"Discovery":
				{
					lock: ["machineAir", 1],
					text: "At first, Halton detected some slight ripple going through Air Realm. What makes him notice it was really odd. It was nearly straight. It had to originate from a place a couple hundred kilometers away. He makes a note about it, but it was left at that. Usually, situations like that would end up with swift Alchemist intervention and nothing could’ve been done to find a new person who delved deeper into Elementalism art. He was that much more surprised when about a year later, with pretty much the around the same place, came a nearly straight and high wave of each Element from the same direction. That was extraordinary. Not only it was extremely rare to have newcomers continue with their studies after meeting Alchemist. Those waves had to be enormous near the origin. And so, Opal was sent out to investigate and hopefully recruit a new person to their team.",
				},
				"Search":
				{
					lock: ["golemInfuser", 1],
					text: "Estimating the exact location was very difficult, but Halton said they had to come from the neighboring country, Seltesia, and the most probable place were the mountains near its capital. It took Opal almost two weeks to reach that location… only to find out that the mountains were massive, and around them were four cities, and any of them had potential to be origin location of waves. | | So her search began, scanning flow of Elements inside and outside of every building in every city. After one month, she was done with the first city. Cursing that she should’ve taken somebody with her, she went on route to next city. | | As time was passing, Opal grew more and more anxious. Maybe Alchemist dealt with the person responsible and she is just wasting her time? Or maybe she is just too slow? Getting used to scanning she searched faster and faster, but spring has ended and second and third cities didn’t have any traces of abnormalities.",
				},
				"Ups and Downs":
				{
					lock: ["golemMerger", 3],
					text: "Reaching the fourth city it was immediately obvious to her that waves happened there. The entire city was surrounded by structured channels of Elements. They weren’t active and started to tranquilize, but still scale of that structure was something she couldn’t believe was possible. It reminded her of the Great Catastrophic Ocean, and how a couple of countries turned into a perfectly round and still body of water. That was a famous ancient story of Great Elementalists and their failed experiments and to this day Water wasn’t easy to control around it. But what could even move such vast amounts of Elements for long enough to create new remains here? Even waves they detected wouldn’t cause this. Slightly happy that her time wasn’t a total waste Opal started scanning through the city. | | Three weeks later she wasn’t happy anymore. Nothing, there was nothing! The only promising location leads her to a small basement room filled with metal rubble. But it was unbelievable that waves originated here, this room was just so small. And whoever was using that room wasn’t coming here anymore. Opal was sitting there for the entire week and nothing happened. Having no luck searching inside the city, she decided to continue the search outside of the city. Yet still, she couldn’t find any traces of activity. After all this time she decided to give up. Apparently whoever managed to create those disturbances have disappeared. Maybe even he got killed by Alchemist if he had a worse mood that day.",
				},
				"Surface":
				{
					lock: ["machineWater", 2],
					text: "Opal packed up her things and went on the long way back. At this point mostly out of habit, she was scanning surroundings as she was walking back. And then she realized. It was more than nothing, on the border of her senses, there was area absolutely devoid of Elements. Usually, each Element would flow in high and lower concentrations, but noticing nothing at all was as unusual as the orderly flow of Elements around the city. | | Arriving near the abnormality Opal made a throughout scan and result was that there was a huge area beneath the ground where Elements would simply completely avoid entering it. Something was redirecting any flow around it. And the whole area was huge, cylindrical in shape, with more than 50 meters in diameter. Two hours spent looking for entrance made her bitter. Again, nothing. Like some kind of curse, everything is going as hard for her as it possibly can. But it’s not something that will stop her. Standing near the outside border of abnormal area, she attuned herself to Earth and slowly started opening a hole below herself by moving Earth to sides.",
				},
				"Underground":
				{
					lock: ["machineWater", 2],
					text: "As Opal descended she found out what caused the anomaly, multiple pipes filled to brim with Elements and carved with patterns she never saw before. That’s exciting, just like everybody in her team, the person who created those has a completely new way of controlling Elements. She had to get inside the structure though, and pipes were quite densely packed. Opal couldn’t sense any gaps through the pipe barrier, but she found a spot where there wasn’t solid rock behind the barrier. She made a small gap there, just enough to fit a finger through it, and used her uniquely developed skill. Attuning herself to Air, she ‘blinked’ through that gap. She spent a bit of time fixing hole she dug up and then she started exploring the structure. | | The structure was huge, yet mostly empty, there was a large central room with a few smaller rooms around it. In the smaller rooms, she only found a couple of tables littered with tiny metal pieces. In the main room, she found decently sized contraption in the middle. And it made her jaw drop to the floor.",
				},
				"Findings":
				{
					lock: ["machineWater", 2],
					text: "It was a grouping of eleven machines, arranged in specific spots of a big alchemical circle embossed into the floor. In nine of those machines was located an Elemental Orb, and filled with a small amount of Element. And that was the first thing that amazed her. With four Orbs containing basic Elements, there were also 5 containing advanced Elements, like Ice and Magma. Last time she saw small traces of those was when Halton pulled couple units of Ice, sacrificing two weeks of his best efforts on it. | | Machines were also running automatically and instead of direct interactions with Elemental Realms, they were instead ‘converting’ different Elements by opening small rifts in space, pushing some of the Elements inside and capturing what was leaking back. Opal saw a bit of research on automated Elementalism before, but she never saw such complicated processes running so smoothly and effortlessly. After all creator of those mini wonders wasn’t here, and they showed no signs of breaking or destabilizing. And Elements weren’t transferred between machines with commonly used pipes, but instead, they were instantly teleported by some mysterious means. All that time and effort she spent looking for a newcomer to the Art wasn’t wasted at all. She found so many exciting inventions she could hardly contain her happiness. That was when she heard a shout behind her and she found one more thing. She found herself staring down the barrel of the rifle.",
				},
				"Meeting":
				{
					lock: ["machineWater", 2],
					text: "She slowly got back up with her arms raised. She saw a young man in a long coat, holding a rifle with visible experience. As she was still attuned to Air, she could easily avoid the bullet, but she didn’t want to accidentally make an enemy out of him, so she decided to play along. | | [ Hello. My name is Opal and mean no harm. Can we talk? ] | He was standing firmly couple meters away from her, still aiming his gun at her. | | [ I’ll ask one more time. Who are you and what are you doing here? ] | | [ I came here looking for the beginner in Elementalism, who didn’t stop after meeting Alchemist. I guess you can call me outdoor agent working for our team who opposes that old man. ] | As he heard the word ‘Alchemist’, he narrowed his eyes, but he budged when he heard that she was on the opposing side. After a few seconds, he finally lowered rifle and relaxed a bit. In her mind, Opal sighed with relief. She took that moment to scan him and she had to strain every bit of her will to not drop her jaw again. On the surface he looked normal, maybe the only weird thing was that he was wearing Elemental Glove. His entire body was literally filled with Elements. Every bit of muscle was flashing with Fire, veins were pumping Water, bones shined with a greenish hint of Earth, and it all was even more intense on both of his arms. She was shocked at how he was even able to move in that condition. His voice woke her back up. | | [ Alright, Opal? so what do you want to talk about? ] | | [ Ah, yes, right. Let me just confirm, it was you who built this thing? ] She said, pointing at machines beside them. | | [ Yes. ] | | [ Awesome! I mean they are just so cool. How did you make them? Was there somebody who taught you who to do that? Can you show me how you work? Did you discover something else? Oh, and those symbols on the ground, I never saw them before, where did you find those? I couldn’t see where the...] After spewing rapid-fire questions, she cut off gasping for air. And he took a step back, with a slightly panicked expression. |  No no no, no, I’m sorry. One at the time then? Let’s calm down and start simple. How can I call you? ] | | [ Vull. Calm down, would you? ] | | [ Sorry again. Before answering those, tell me, how did you meet Alchemist before? Did he try to kill you too? ] | | [ Alchemist tries to stop everybody from researching Elementalism, everybody in my team met him this way or another. ] | | [ I see. So what do you want to know? ] | | [ How did you learn how to use Elementalism? ] | | [ I learned everything I know from public books and my own study. ] | | [ Really?! You have to see the rest of my team then. Would you come with me to see them? ] | | [ What? No, I’m not going anywhere. I have my workshop set up here and I don’t see what I’d gain from it. ] | | [ Right, right. My bad. I can guarantee you we will keep Alchemist at bay when you will be with us. And we’ll share knowledge with each other. Doesn’t that sound alright? ]",
				},
				"Meeting":
				{
					lock: ["machineWater", 2],
					text: "She slowly got back up with her arms raised. She saw a young man in a long coat, holding a rifle with visible experience. As she was still attuned to Air, she could easily avoid the bullet, but she didn’t want to accidentally make an enemy out of him, so she decided to play along. | | [ Hello. My name is Opal and mean no harm. Can we talk? ] | He was standing firmly couple meters away from her, still aiming his gun at her. | | [ I’ll ask one more time. Who are you and what are you doing here? ] | | [ I came here looking for the beginner in Elementalism, who didn’t stop after meeting Alchemist. I guess you can call me outdoor agent working for our team who opposes that old man. ] | As he heard the word ‘Alchemist’, he narrowed his eyes, but he budged when he heard that she was on the opposing side. After a few seconds, he finally lowered rifle and relaxed a bit. In her mind, Opal sighed with relief. She took that moment to scan him and she had to strain every bit of her will to not drop her jaw again. On the surface he looked normal, maybe the only weird thing was that he was wearing Elemental Glove. His entire body was literally filled with Elements. Every bit of muscle was flashing with Fire, veins were pumping Water, bones shined with a greenish hint of Earth, and it all was even more intense on both of his arms. She was shocked at how he was even able to move in that condition. His voice woke her back up. | | [ Alright, Opal? so what do you want to talk about? ] | | [ Ah, yes, right. Let me just confirm, it was you who built this thing? ] She said, pointing at machines beside them. | | [ Yes. ] | | [ Awesome! I mean they are just so cool. How did you make them? Was there somebody who taught you who to do that? Can you show me how you work? Did you discover something else? Oh, and those symbols on the ground, I never saw them before, where did you find those? I couldn’t see where the...] After spewing rapid-fire questions, she cut off gasping for air. And he took a step back, with a slightly panicked expression. [  No no no, no, I’m sorry. One at the time then? Let’s calm down and start simple. How can I call you? ] | | [ Vull. Calm down, would you? ] | | [ Sorry again. Before answering those, tell me, how did you meet Alchemist before? Did he try to kill you too? ] | | [ Alchemist tries to stop everybody from researching Elementalism, everybody in my team met him this way or another. ] | | [ I see. So what do you want to know? ] | | [ How did you learn how to use Elementalism? ] | | [ I learned everything I know from public books and my own study. ] | | [ Really?! You have to see the rest of my team then. Would you come with me to see them? ] | | [ What? No, I’m not going anywhere. I have my workshop set up here and I don’t see what I’d gain from it. ] | | [ Right, right. My bad. I can guarantee you we will keep Alchemist at bay when you will be with us. And we’ll share knowledge with each other. Doesn’t that sound alright? ]",
				},
				"Way back":
				{
					lock: ["machineWater", 2],
					text: "They discussed like this o lot longer, but in the end, Opal couldn’t convince Vull to go with her. But she had to let others meet him, it’s the biggest breakthrough she saw this decade, maybe even more important that Halton’s reverse rifting. She decided to bring her team here instead. A few hours later she set off on the way back, but this time she was constantly blinking forward instead of walking. She felt that every minute she spends away from that underground wonder room is working against her. She was back home in less than a week, barely standing straight up, but with an air of determination in her eyes.",
				},
			}
		},
		Research:
		{
			text: "TO BE RELEASED SOON",
			/*
						"Utility":
						{
							"Time":
							{
								lock: ["machineTime", 0],
								text: "'Time' in quotation marks. Represents not in-game time, but rather the time during which machines do their work. | | Creating more Time is similar to map-wide speed up, while spending it will slow down the overall production. | | Game spends 16.7 Time to generate a tick of work. Game has basic production of Time of 1000 per second of real time. | | Offline progression rewards you a lot from closing a game while you can't actively play. It is designed to be more optimal to close the game than leaving it on. Especially through the night.",
							},
							"Limits":
							{
								lock: ["machineTime", 0],
								text: "NormalLimit represents cap on ticks that can happen per frame of animation. This is carefully designed to keep stable TPS, while preventing any cases of script hanging up in browsers. | | If you have a lot of Time, you can use turbo recipes in Rabbit Hole for to speed up a game. A lot. It is not 100% efficient way of spending Time though, so don't leave them on if you run out of Time.",
							},
							"Rabbit Hole":
							{
								lock: ["machineTime", 0],
								text: "Utility machine, doesn't exist in lore. | | Slowdown recipe only slows down the game. Use it if something is happening too fast and you want to troubleshoot something. | | Turbo Spender simply changes limit to TurboLimit | | Turbo Time Bend multiplies scaling recipes speed by a factor of 10 without impacting the game's performance.",
							},
						},
						"Research":
						{
							"Revelation":
							{
								lock: ["Revelation", 1e-10],
								text: "The hidden vault inside my mind. | | It's lock consumed by the Alkahest.",
							},
							"Knowledge":
							{
								lock: ["Knowledge", 1e-10],
								text: "The secrets that have been uncovered. | | The principles that have been understood. | | The limits that have been overcame. | | The designs that have been studied. | | The work that has not been done. | | The work that needs to be done.",
							},
							"Mystery":
							{
								lock: ["Mystery", 1e-10],
								text: "Even though I know so much. | | This... | | This still is a mystery...",
							},
						},
						"Elements":
						{
							"Alkahest":
							{
								lock: ["Alkahest", -1e-10],
								text: "What a mysterious substance. | | While technically it is an Element, it doesn't have any of the usual properties. | | It's inanimate, yet behaves like an extremely infectious diesease, or rather, like a starving beast. When it touches anything, the touched matter gets instantly sucked into the Alkahest, and immediately dissolved, leaving no trace it ever existed before. All elemental flows around it die down, leaving perfectly empty area devoid of anything but the Alkahest itself. | | Thankfully my orb coating keeps it confined in it's orb, and is insulating the influence enough to keep Elements flowing outside of it. Now, how can it be used? Trying to manipulate with Glove is futile, it seems that manipulations are based on flow of some kind, and that is consumed by Alkahest. It bended itself towards me every time I tried that. Fascinating.",
							},
							"Tier 1":
							{
								"Earth":
								{
									lock: ["Earth", 1e-10],
									text: "The primal Element of Earth. | | Present in all matter, but biggest concentrations are found in solid rocks and crystals. Also it is very easily exctractable from dust, or debris created during excavation of my base, so it's best starting point to any of my experiments. | | It is helpful in construction of solid structures, and by manipulating Earth contained in rocks and ground around I was able to create a huge cave, and further stabilize it to prevent it from collapsing.",
								},
								"Water":
								{
									lock: ["Water", -1e-10],
									text: "The primal Element of Water. | | Present in all matter, but biggest concentrations are found in various liquids. It's natural tendency to circulate, even if it's idle, helps enchancing anything system related to flow of the Elements.",
								},
								"Air":
								{
									lock: ["Air", -1e-10],
									text: "The primal Element of Air. | | Present in all matter, but biggest concentrations are found in various gases.  While it is most common of the primals, it is really hard to pull any substantial amount of it out of breathable air. It is very light weight, spacious. I have easiest time manipulating and improving all kinds of rifts and subspace transport with Glove filled with the Air, and as a consequence helps increase processing speed of machines.",
								},
								"Fire":
								{
									lock: ["Fire", -1e-10],
									text: "The primal Element of Air. | | Present in all matter, but not present anywhere in substantial concentrations. Very energetic, but not as volatile as normal fire. Filling alchemical symbols and formations with it causes the reactions to occur more smoothly, increasing the efficiency.",
								},
							},
							"Golems":
							{
								"GolemEarth":
								{
									lock: ["GolemEarth", -1e-10],
									text: "",
								},
								"GolemWater":
								{
									lock: ["GolemWater", -1e-10],
									text: "",
								},
								"GolemAir":
								{
									lock: ["GolemAir", -1e-10],
									text: "",
								},
								"GolemFire":
								{
									lock: ["GolemFire", -1e-10],
									text: "",
								},
							},
							"Tier 2":
							{
								"Mud":
								{
									lock: ["Mud", -1e-10],
									text: "",
								},
								"Ice":
								{
									lock: ["Ice", -1e-10],
									text: "",
								},
								"Steam":
								{
									lock: ["Steam", -1e-10],
									text: "",
								},
								"Sand":
								{
									lock: ["Sand", -1e-10],
									text: "",
								},
								"Magma":
								{
									lock: ["Magma", -1e-10],
									text: "",
								},
								"Void":
								{
									lock: ["Void", -1e-10],
									text: "",
								},
							},
							"Tier 3":
							{
								"Essence":
								{
									lock: ["Essence", -1e-10],
									text: "",
								},
								"Soil":
								{
									lock: ["Soil", -1e-10],
									text: "",
								},
								"Obsidian":
								{
									lock: ["Obsidian", -1e-10],
									text: "",
								},
								"Lava":
								{
									lock: ["Lava", -1e-10],
									text: "",
								},
								"Oil":
								{
									lock: ["Oil", -1e-10],
									text: "",
								},
								"Force":
								{
									lock: ["Force", -1e-10],
									text: "",
								},
								"Space":
								{
									lock: ["Space", -1e-10],
									text: "",
								},
								"Glass":
								{
									lock: ["Glass", -1e-10],
									text: "",
								},
								"Gold":
								{
									lock: ["Gold", -1e-10],
									text: "",
								},
								"Snow":
								{
									lock: ["Snow", -1e-10],
									text: "",
								},
								"Cryogen":
								{
									lock: ["Cryogen", -1e-10],
									text: "",
								},
							},
						},
						"Expansive":
						{
							"Spatial":
							{
								lock: ["Spatial", -1e-10],
								text: "",
							},
							"Temporal":
							{
								lock: ["Temporal", -1e-10],
								text: "",
							},
							"Parallel":
							{
								lock: ["Parallel", -1e-10],
								text: "",
							},
							"FoldedSpace":
							{
								lock: ["FoldedSpace", -1e-10],
								text: "",
							},
							"FoldedSpatial":
							{
								lock: ["FoldedSpatial", -1e-10],
								text: "",
							},
							"FoldedTemporal":
							{
								lock: ["FoldedTemporal", -1e-10],
								text: "",
							},
						},
						"Compunds":
						{
							"Solution":
							{
								lock: ["Solution", -1e-10],
								text: "",
							},
							"Distillates":
							{
								lock: ["DistilledEarth", -1e-10, "DistilledWater", -1e-10, "DistilledAir", -1e-10, "DistilledFire", -1e-10],
								text: "",
							},
							"Pressure":
							{
								lock: ["Pressure", -1e-10],
								text: "",
							},
							"Compressed":
							{
								lock: ["CompressedEarth", -1e-10, "CompressedWater", -1e-10, "CompressedAir", -1e-10, "CompressedFire", -1e-10],
								text: "",
							},
						},
						"Vigorious":
						{
							"Essences":
							{
								lock: ["EssenceEarth", -1e-10, "EssenceWater", -1e-10, "EssenceAir", -1e-10, "EssenceFire", -1e-10],
								text: "",
							},
							"Soils":
							{
								lock: ["SoilEarth", -1e-10, "SoilWater", -1e-10, "SoilAir", -1e-10, "SoilFire", -1e-10],
								text: "",
							},
							"Earth Seed":
							{
								lock: ["SeedEarth", -1e-10],
								text: "",
							},
							"Water Seed":
							{
								lock: ["SeedWater", -1e-10],
								text: "",
							},
							"Air Seed":
							{
								lock: ["SeedAir", -1e-10],
								text: "",
							},
							"Fire Seed":
							{
								lock: ["SeedFire", -1e-10],
								text: "",
							},
							"Plants":
							{
								lock: ["PlantEarth", -1e-10],
								text: "",
							},
							"Pure Essences":
							{
								lock: ["PureEssenceEarth", -1e-10],
								text: "",
							},
						},
						"Frozen":
						{
							"Coolant":
							{
								lock: ["Coolant", -1e-10],
								text: "",
							},
							"Gale":
							{
								lock: ["Gale", -1e-10],
								text: "",
							},
							"Cryospire":
							{
								lock: ["Cryospire", -1e-10],
								text: "",
							},
							"Vortex":
							{
								lock: ["Vortex", -1e-10],
								text: "",
							},
						},
						"Burnt":
						{
							"Blaze":
							{
								lock: ["Blaze", -1e-10],
								text: "",
							},
							"Blast":
							{
								lock: ["Blast", -1e-10],
								text: "",
							},
							"Pyro":
							{
								lock: ["Pyro", -1e-10],
								text: "",
							},
							"Coal":
							{
								lock: ["Coal", -1e-10],
								text: "",
							},
							"Sulphur":
							{
								lock: ["Sulphur", -1e-10],
								text: "",
							},
							"Propane":
							{
								lock: ["Propane", -1e-10],
								text: "",
							},
							"Ash":
							{
								lock: ["Ash", -1e-10],
								text: "",
							},
							"Dust":
							{
								lock: ["Dust", -1e-10],
								text: "",
							},
							"Carbon":
							{
								lock: ["Carbon", -1e-10],
								text: "",
							},
						},
						"Industrial":
						{
							"Power":
							{
								lock: ["Power", -1e-10],
								text: "",
							},
							"Energy":
							{
								lock: ["Energy", -1e-10],
								text: "",
							},
							"Fuel":
							{
								lock: ["Fuel", -1e-10],
								text: "",
							},
							"Diesel":
							{
								lock: ["Diesel", -1e-10],
								text: "",
							},
							"Petrol":
							{
								lock: ["Petrol", -1e-10],
								text: "",
							},
							"Propene":
							{
								lock: ["Propene", -1e-10],
								text: "",
							},
						},
						"Material":
						{
							"Silver":
							{
								lock: ["Silver", -1e-10],
								text: "",
							},
							"Bronze":
							{
								lock: ["Bronze", -1e-10],
								text: "",
							},
							"Copper":
							{
								lock: ["Copper", -1e-10],
								text: "",
							},
							"Tin":
							{
								lock: ["Tin", -1e-10],
								text: "",
							},
							"Aluminum":
							{
								lock: ["Aluminum", -1e-10],
								text: "",
							},
							"Iron":
							{
								lock: ["Iron", -1e-10],
								text: "",
							},
							"Steel":
							{
								lock: ["Steel", -1e-10],
								text: "",
							},
							"Clay":
							{
								lock: ["Clay", -1e-10],
								text: "",
							},
							"Plastic":
							{
								lock: ["Plastic", -1e-10],
								text: "",
							},
							"Silicon":
							{
								lock: ["Silicon", -1e-10],
								text: "",
							},
							"Acid":
							{
								lock: ["Acid", -1e-10],
								text: "",
							},
							"Mayo":
							{
								lock: ["Mayo", -1e-10],
								text: "",
							},
						},
						"Pureness":
						{
							"PureEarth":
							{
								lock: ["PureEarth", -1e-10],
								text: "",
							},
							"PureWater":
							{
								lock: ["PureWater", -1e-10],
								text: "",
							},
							"PureAir":
							{
								lock: ["PureAir", -1e-10],
								text: "",
							},
							"PureFire":
							{
								lock: ["PureFire", -1e-10],
								text: "",
							},
							"SterileGlass":
							{
								lock: ["SterileGlass", -1e-10],
								text: "",
							},
							"CompressionCrystal":
							{
								lock: ["CompressionCrystal", -1e-10],
								text: "",
							},
							"PerfectedOrb":
							{
								lock: ["PerfectedOrb", -1e-10],
								text: "",
							},
							"PureGolemEarth":
							{
								lock: ["PureGolemEarth", -1e-10],
								text: "",
							},
							"PureGolemWater":
							{
								lock: ["PureGolemWater", -1e-10],
								text: "",
							},
							"PureGolemAir":
							{
								lock: ["PureGolemAir", -1e-10],
								text: "",
							},
							"PureGolemFire":
							{
								lock: ["PureGolemFire", -1e-10],
								text: "",
							},

						},*/
		},
		General:
		{
			text: "Currently this section is empty",
		},
	},
	recurHide: function (node)
	{
		regionData.hideRegion.action(node.pane);
		for (var i = 0; i < node.list.length; i++)
		{
			this.recurHide(node.list[i]);
		}
	},
	buttonMouseHandler: function (pane, x, y, type)
	{
		if (type == "mouseup")
		{
			if (this.markedToSuperGlow)
			{
				lorePane.region.markedToSuperGlow = false;
				this.markedToSuperGlow = false;
				var unglow = this.node.top;
				while (unglow.button)
				{
					unglow.button.markedToSuperGlow = false;
					unglow = unglow.top;
				}
			}
			var topList = this.node.top.list;
			for (var i = 0; i < this.node.index; i++)
			{
				regionData.showRegion.action(topList[i].button);
				topList[i].button.focus = "left";
				lore.recurHide(topList[i]);
			}
			for (var i = topList.length - 1; i > this.node.index; i--)
			{
				regionData.showRegion.action(topList[i].button);
				topList[i].button.focus = "right";
				lore.recurHide(topList[i]);
			}
			regionData.showRegion.action(this);
			if (!this.locked)
			{
				regionData.showRegion.action(this.node.pane);
				topList[i].pane.scrollRate = 0;
				topList[i].pane.boundaryPath = new Path2D();
				this.opened = true;
			}
			this.focus = "center";
		}
	},
	buttonCustomDraw: function (ctx)
	{
		ctx.save();
		var x = 60;
		if (this.focus == "right")
		{
			x = 70;
		}
		else if (this.focus == "left")
		{
			x = 50;
		}
		else if (this.opened)
		{
			ctx.fillStyle = "#321632";
			ctx.fill(this.boundaryPath);
		}
		if (!this.locked)
		{
			ctx.fillStyle = ctx.strokeStyle;
			ctx.fillText(this.node.name, x, 10);
		}
		ctx.restore();
	},
	paneCustomDraw: function (ctx)
	{
		ctx.save();

		if (this.scrollRate < this.scrollMax)
		{
			this.scrollRate++;
			this.boundaryPath = new Path2D();
			if (this.node.list.length > 0)
			{
				this.boundaryPath.rect(0, 0, 20 + 100 * this.node.list.length, this.scrollRate / this.scrollMax * 20);
			}
			else
			{
				this.scrollMax = 30;
				if (this.maxTextY)
				{
					this.boundaryPath.rect(0, 0, 400 * this.columnCount, this.scrollRate / this.scrollMax * this.maxTextY);
				}
				else
				{
					this.boundaryPath.rect(0, 0, 400 * this.columnCount, this.scrollRate * 3);
				}

			}
			if (this.scrollRate >= this.scrollMax)
			{
				for (var i = 0; i < this.node.list.length; i++)
				{
					if (this.node.list[i].button.opened && this.node.list[i].button.focus == "center")
					{
						regionData.showRegion.action(this.node.list[i].pane);
						this.node.list[i].pane.scrollRate = 0;
						this.node.list[i].pane.boundaryPath = new Path2D();
					}
				}
			}
		}
		if (this.text)
		{
			if (this.textCanvas)
			{
				ctx.drawImage(this.textCanvas, 0, 0);
			}
			else
			{
				this.textCanvas = document.createElement('canvas');
				this.textCanvas.width = 400;
				this.textCanvas.height = 50;
				var ctxText = this.textCanvas.getContext('2d');
				ctxText.font = "14px Arial";
				ctxText.textAlign = "center";
				var words = this.text.split(" ");
				var lines = [];
				var i;
				for (i = 0; i < words.length; i++)
				{
					words[i] = words[i].replace(/_/g, " ");
				}
				i = 0;
				var line;
				var testLine;
				var y = 25;
				while (i < words.length)
				{
					if (words[i] == "|")
					{
						i++;
						if (line === null)
						{
							lines.push("");
							if (lines.length <= 25)
							{
								y += 20;
							}
						}
						line = null;
						continue;
					}
					line = "";
					testLine = words[i] + " ";
					while (ctx.measureText(testLine).width < 380)
					{
						line += words[i++] + " ";
						if (i >= words.length || words[i] == "|")
						{
							break;
						}
						testLine += words[i] + " ";
					}
					lines.push(line);
					this.columnCount = 1 + Math.floor(lines.length / 25);
					if (lines.length <= 25)
					{
						y += 20;
					}
				}
				this.maxTextY = y;
				this.textCanvas.width = 400 * this.columnCount;
				this.textCanvas.height = 25 + y;
				ctxText = this.textCanvas.getContext('2d');
				ctxText.font = "14px Arial";
				ctxText.textAlign = "left";
				ctxText.fillStyle = ctx.fillStyle;
				ctxText.fill(this.boundaryPath);
				ctxText.fillStyle = ctx.strokeStyle;
				ctxText.strokeStyle = ctx.strokeStyle;
				for (i = 0; i < lines.length; i++)
				{
					ctxText.fillText(lines[i], 10 + 400 * Math.floor(i / 25), 25 + 20 * (i % 25));
				}
				for (i = 1; i < this.columnCount; i++)
				{
					ctxText.beginPath();
					ctxText.moveTo(400 * i, 10);
					ctxText.lineTo(400 * i, 40 + 20 * 24);
					ctxText.stroke();
				}
			}
		}
		ctx.restore();
	},
};

function reccurentLoreTick(node)
{
	var change = false;
	if (node.list.length > 0)
	{
		for (var i = 0; i < node.list.length; i++)
		{
			change = reccurentLoreTick(node.list[i]) || change;
		}
	}
	else if (node.lock)
	{
		if (machineData[node.lock[0]])
		{
			change = machineData[node.lock[0]].recipes[node.lock[1]].unlocked;
		}
		else if (data.oElements[node.lock[0]])
		{
			change = data.oElements[node.lock[0]].amount >= node.lock[1];
		}

		if (change)
		{
			node.lock = null;
		}
	}

	if (node.button && change)
	{
		node.button.locked = false;
		node.button.markedToSuperGlow = true;
	}
	return change;
}

function reccurentLoreUnTick(node)
{
	if (node.list.length > 0)
	{
		for (var i = 0; i < node.list.length; i++)
		{
			reccurentLoreUnTick(node.list[i]);
		}
	}
	if (node.button && node.button.markedToSuperGlow)
	{
		node.button.markedToSuperGlow = false;
	}
}

function tickLore()
{
	if (reccurentLoreTick(lore.dataTree))
	{
		lorePane.region.markedToSuperGlow = true;
	}
}

function processLore(loreNode, top)
{
	var node = {};
	node.top = top;
	node.index = top.list.length;
	top.list.push(node);

	node.list = [];

	var buttonPane = new cPane(top.pane, 100 * node.index, 0);
	buttonPane.node = node;
	buttonPane.boundaryPath = new Path2D();
	buttonPane.boundaryPath.rect(0, 0, 120, 20);
	buttonPane.mouseHandler = lore.buttonMouseHandler;
	buttonPane.customDraw = lore.buttonCustomDraw;
	var showPane = new cPane(top.pane, 0, 21);
	showPane.node = node;
	showPane.boundaryPath = new Path2D();
	showPane.independent = true;
	showPane.scrollMax = 10;
	showPane.columnCount = 1;
	showPane.customDraw = lore.paneCustomDraw;
	regionData.hideRegion.action(showPane);

	node.button = buttonPane;
	node.pane = showPane;

	var leaf = true;
	var father = false;
	for (var branch in loreNode)
	{
		switch (branch)
		{
			case "lock":
				buttonPane.locked = true;
				node.lock = loreNode[branch];
				break;
			case "text":
				showPane.text = loreNode.text;
				break;
			default:
				father = true;
				var temp = processLore(loreNode[branch], node);
				temp.name = branch;
				if (!temp.button.locked)
				{
					leaf = false;
				}
		}
	}
	if (father)
	{
		buttonPane.locked = leaf;
	}
	if (node.list.length > 0)
	{
		for (var i = node.list.length - 1; i > 0; i--)
		{
			regionData.showRegion.action(node.list[i].button);
			node.list[i].button.focus = "right";
		}
		regionData.showRegion.action(node.list[0].button);
		node.list[0].button.focus = "center";
		regionData.hideRegion.action(node.list[0].pane);
	}
	return node;
};

function preprocessLore()
{
	lorePane.boundaryPath = new Path2D();

	lore.dataTree = {};
	lore.dataTree.list = [];
	lore.dataTree.pane = lorePane;
	for (var branch in lore.loreTree)
	{
		var node = processLore(lore.loreTree[branch], lore.dataTree);
		node.name = branch;
		node.button.y += optionData.iconSize;
		node.button.defaultY += optionData.iconSize;
		node.pane.y += optionData.iconSize;
		node.pane.defaultY += optionData.iconSize;
	}
	lorePane.boundaryPath.rect(0, 0, 20 + 100 * lore.dataTree.list.length, optionData.iconSize + 20);
	if (lore.dataTree.list.length > 0)
	{
		for (var i = lore.dataTree.list.length - 1; i > 0; i--)
		{
			regionData.showRegion.action(lore.dataTree.list[i].button);
			lore.dataTree.list[i].button.focus = "right";
		}
		regionData.showRegion.action(lore.dataTree.list[0].button);
		lore.dataTree.list[0].button.focus = "center";
		regionData.hideRegion.action(lore.dataTree.list[0].pane);
	}
	regionData.hideRegion.action(lorePane);
}
