var lore = {
	"loreMessages" : {
		"start0" : {
			"text" :
				"After a few days of tinkering with Elements I discovered Golems.\n"+
				"Touching all of them at the same time created some sort of bright flash.\n"+
				"I saw an old man running towards me, and his shout rendered me unconscious.\n"+
				"Later on I woke up in the middle of attic, but everything else there was gone.\n\n"+
				"Few hours later I recovered enough to move again.\n"+
				"Walking out of the house presented me with another surprise.\n"+
				"It appears I was there for a long time. Looking at the date on freshest newspaper...\n"+
				"7 months ago I went out looking out for machine parts. 7 months.\n\n"+
				"As this revelation slowly started sinking in I remembered the state my father was.\n"+
				"Scholars gave him only few weeks... I went to the clinic.\n"+
				"\n----------------------------------------------------------------------------------\n\n"+
				"Sadness that I felt for past month slowly turned into hatred towards that old man in vision.\n"+
				"If it wasn't for him I would at least be with my father during his last breaths.\n"+
				"I know what I want to do. I want to go back there.\n\n"+
				"Fused Elemental Glove in my right arm wasn't something old man wanted.\n"+
				"Now I was able to hold two different Elements in it at the same time.\n"+
				"But whenever I try to do something white light appears around my chest\n"+
				"and after few seconds causes nullifying elemental wave. It is like a curse.\n\n"+
				"I still should be able to do all things I could before, I just need to\n"+
				"improve my equipment. And so my preparation began.\n"+
				"\n----------------------------------------------------------------------------------\n\n"+
				"Few months have passed.\n\n"+
				"I gathered a lot more machine parts and remade machines I used last time.\n"+
				"During that time I made two big discoveries. First - compression crystals made with my glove\n"+
				"are a bit different. They seems to infinitely compress elements. Applying them\n"+
				"to machines and Orbs were surprisingly easy. I remade 4 Orbs into room-sized Tanks\n"+
				"and gathered a bunch more for Golem experiments. I think I'm ready to make a push for it.\n\n"+
				"With new crystals I was able to reverse engineer how they link to other side.\n"+
				"I should be able to make a small rifts and pull Elements directly from it.\n"+
				"\n----------------------------------------------------------------------------------"
		},
		"rifts0" : {
			"text" :
				"I don't think I will be able to reach high enough amounts of Elements with Rifts alone.\n"+
				"The problem is... I don't know how Catalyst in my grandma's attic was made.\n"+
				"Well, I'll just remake it's shape and we'll see how it goes from there.\n\n"+
				"That's interesting. I don't really understand why it's increasing efficiency of reactions, but\n"+
				"surrounding it with Air seems to increase speed of reactions as well.\n"+
				"I think focusing Fire around Catalyst lessens natural barriers and pulls more\n"+
				"a bit of Elements from the same source as rifts.\n\n"+
				"Anyway, with Catalyst ready I just need to install it in the middle of the room.\n"+
				"\n----------------------------------------------------------------------------------"
		},
		"catalyst0" : {
			"text" :
				"Elemental wave caused by my curse focused on Catalyst and soon after shattered it.\n"+
				"I guess strain of wave focusing around it is just too strong.\n"+
				"At least after creating Catalyst from scratch gave me a bit of additional knowledge\n"+
				"about Elements. I'll modify Catalyst to go on the outside of the conversion machines.\n"+
				"Giving it for of a ring will spread out wave forces on larger surface. It should be enough.\n"+
				"\n----------------------------------------------------------------------------------"
		},
		"catalyst1" : {
			"text" :
				"Yes, it works! Sadly it seems that new Catalyst structure is much weaker.\n"+
				"But in the long run I still should be able to get massive amounts of the Elements.\n\n"+
				"Now it's time to focus on my goal, getting back Golems.\n"+
				"I don't want to randomly cause their creation anymore, so I devised special machine.\n"+
				"Infusion chamber will let me control a processes with valves. With few dozens\n"+
				"empty Orbs I'll even be able to try making multiple Golems of same type.\n"+
				"I cannot wait to explore new possibilities.\n"+
				"\n----------------------------------------------------------------------------------"
		},
		"stash0" : {
			"text" :
				"Losing all my Elements each time I create a Golem is slowing my progress a lot.\n"+
				"But seeing Elemental waves 'thanks' to my curse I was able to understand it a bit better.\n"+
				"Wave propagates through the space using small bits of Elements that naturally appear\n"+
				"in the world around me. And waves from my curse are a bit weaker than Golem's ones,\n"+
				"so they only get to tanks that I used during upgrading process. This means simple\n"+
				"isolation barrier should be able to stop waves from getting inside my containers.\n\n"+
				"Sadly including that barrier inside my tanks would render them unusable with\n"+
				"my current subspace piping technology, I should still be able to make a special container\n"+
				"that'd be safe from waves. Pumping Elements in and out of it will be problematic.\n"+
				"Well, I have a plan. I'll only be able to retrieve a small portion of stored Elements\n"+
				"after each wave created during process of upgrading or golem creation, but it's better.\n"+
				"than starting from scratch\n"+
				"\n----------------------------------------------------------------------------------"
		},
		"merge0" : {
			"text" :
				"Elemental wave created by Golem pulled another one to it and darkness surrounded them.\n"+
				"I think the process started due to vast amounts of Elements present in the room.\n\n"+
				"After a while of intense spinning two Golems merged into one.\n"+
				"That's... insane. There are only 4 Elements. What's inside new one? I cannot interact\n"+
				"with it using my gloved arm. For now I just have to make sure this accident doesn't\n"+
				"happen again. From now on I'll put all golems on stable pedestals.\n\n\n"+
				"Experimenting with new golem is most interesting thing I've ever done.\n"+
				"While I used normal Golems to help gathering their respective Elements I cannot\n"+
				"to the same with this one. But it emanates faint aura that spread across all room and\n"+
				"it seems that it enhanced my machines in some weird way. I'll try to document details of\n"+
				"that power later. Now question is... if that combination of base Golems created this, then\n"+
				"what happens when I'll try another combination?\n\n"+
				"Thanks to all my experiences with creating Golems I was able to construct tiny version\n"+
				"of Orbs. I only need a bit of Elements to turn them into Golems, but they dissipate after\n"+
				"a few minutes. Thanks to their size I was able to contain their waves inside isolated study.\n"+
				"With them I've done more test and indeed all combinations of base Golems create different\n"+
				"'advanced' Golems. I've also tested their powers and they are so much different then\n"+
				"anything I've seen before. My next goal should be making as many of them as possible.\n"+
				"\n----------------------------------------------------------------------------------"
		},
		"eat0" : {
			"text" :
				"It seems that two Golems of the same type can't coexists together inside small space.\n"+
				"Elemental wave caused them to connect, and soon after one drained the other,\n"+
				"only to leave newly created Golem in unstable state that caused small explosion of white light.\n"+
				"Did that damned old man interfere again?\n"+
				"\n----------------------------------------------------------------------------------"
		},
		"infernal0" : {
			"text" :
				"Golem, which I decided to name 'Infernal' feels special.\n"+
				"Not only it seems that it's most powerful of combined Golems, it also has this strange\n"+
				"trend. My calculations noted that it's power to generate all Elements will go down to\n"+
				"nothing at some point. I suspect that after point it'll actually start to drain\n"+
				"Elements from my system. I don't really know what it's gonna do after that, but\n"+
				"it's clear I'll need to get there."
		},
		"infernal1" : {
			"text" :
				"My suspicion was right. As soon as I crossed 1e90 threshold Infernal Golem reversed\n"+
				"it's power and started draining Elements, the more I have the stronger the drain.\n"+
				"It's also growing in size according to it's drain rate.\n\n"+
				"I think giving it enough of all Elements should satisfy it at some point.\n"+
				"I just hope my reactions are strong enough to sustain it.\n"+
				"\n----------------------------------------------------------------------------------"
		},
		"ending0" : {
			"text" :
				"Once Infernal reached it maximal size it rose into the air from pedestal and\n"+
				"started repeatedly sending huge Elemental Waves.\n\n"+
				"First wave cleared all my machines from Elements, even Stash.\n"+
				"Second wave destabilized all other Golems\n\n"+
				"Immense pain flooded my Gloved right arm. I froze in place unable to fight it.\n\n"+
				"Third wave sent all my machines into wall, making improvised spiked barrier around the room.\n"+
				"Fourth wave made other Golems explode into secondary Elemental Waves.\n\n"+
				"Two things happened almost at the same time:\n"+
				"----------------------------------------------------------------------------------\n"+
				"Bright white light appeared on one of the walls.\n"+
				"Secondary waves from Golems reached Infernal and began changing him.\n"+
				"----------------------------------------------------------------------------------\n"+
				"Silhouette of the old man stepped through the light wall.\n"+
				"Eyes of Infernal Golem gained focus and he looked around the room.\n"+
				"----------------------------------------------------------------------------------\n"+
				"Old man noticed me and turned towards me. \"You...\"\n"+
				"Infernal Golem stopped emitting waves and shrank a little.\n"+
				"----------------------------------------------------------------------------------\n"+
				"Single finger pointed towards me. \"I can't let you do this.\"\n"+
				"Infernal suddenly launched towards me.\n"+
				"----------------------------------------------------------------------------------\n"+
				"\"I'm sorry.\" - instant beam of light pointing at my chest, at first weak, but warm\n"+
				"My golem hit me from my left side and pushed me into the spiked wall to my right.\n"+
				"----------------------------------------------------------------------------------\n"+
				"I think Golem took the hit from the light. I blinked.\n"+
				"Infernal vanished. Light was also gone. Old man looked exactly like Alchemist in books.\n"+
				"I hit the wall and felt spikes piercing my body. New pain.\n"+
				"Old man said:\"I guess those spikes did it in my steed\"\n"+
				"I saw old man turning around and walking into the wall.\n"+
				"\"At least I don't feel pain in my gloved arm anymore\" was my last thought before\n"+
				"losing consciousness.\n"+
				"\n----------------------------------------------------------------------------------\n\n"+
				"Few hours later:\n"+
				"I woke up on the floor. I got up. No pain, no issues with moving.\n"+
				"I didn't feel this good in weeks of sleepless nights I've spent on preparations.\n"+
				"Confused I looked around. Spikes on walls. So it did happen. Spikes nearest me\n"+
				"are still covered in blood, yet I don't have any wounds. My body looked just as\n"+
				"always until I noticed the glass globe in my left arm, marking a spot I was\n"+
				"hit by Infernal. That's... at this point I wasn't even surprised.\n"+
				"I started thinking what could that mean and how could I use it...\n\n"+
				"While thinking I noticed another small glass globe on the floor near me.\n"+
				"I guess those are remains of Infernal Golems. I reached out to pick it up, but\n"+
				"it got absorbed into my hand and small purple orb appeared inside my own globe.\n\n\n"+
				"\n----------------------------------------------------------------------------------"+
				"\n----------------------------------------------------------------------------------"+
				"\n----------------------------------------------------------------------------------"+
				"\n----------------------------------------------------------------------------------\n\n"+
				"This marks the end of stage two. Thank you for playing\n"+
				"You can now check out sneak peek of main mechanic of stage three.\n"+
				"Click the circle in the middle of main setup.\n\n\n\n"+
				"If you liked the game please consider supporting me.\n"+
				"I'd love to work full time on this game.\n"+
				"\n----------------------------------------------------------------------------------\n\n\n"+
				"Credits\n\n\n"+
				"Production director\n"+
				"Nagshell\n\n"+
				"Art Design\n"+
				"Nagshell\n\n"+
				"Programming\n"+
				"Nagshell\n\n"+
				"Public Relations\n"+
				"Nagshell\n\n"+
				"Moral Support\n"+
				"Silent but Deadly, Essi\n"+
				"Loud sub-woof-er, Baster\n\n"+
				"Supporters on Patreon\n"+
				"\n"+
				"PhantomLemon\n"+
				"ranger10700\n"+
				"Slav\n"
				},
		
	},//"\n"+
	"popupMessages" : {
		"catalyst0" : {
			"text" : 
				"Elemental wave caused by my curse focused on Catalyst.\n"+
				"And soon after shattered it into pieces.",
			//"changeTab" : 0
		},
		"merge0" : {
			"text" :
				"Another Orb imploded into Golem and wave reached another Golem.\n\n"+
				"Darkness filled Orb infuser.\n\n"+
				"I rushed to the center of the room to see what's happening."
		},
		"eat0" : {
			"text" :
				"Elemental wave created by new Golem reached another Golem of same type.\n"+
				"Something is not right..."
		},
		
	},
	"bannerMessages" : {
		"overflow0" : {
			"text" : "Open all conversion machine valves to create loop."
		},
		"upgradeCost0" : {
			"text" : "Curse clears Elements used in upgrades, including respective tanks and machines."
		},
		"machineSpeed0" : {
			"text" : "Rotation speed multiplies speed of conversion. Very effective with highly upgraded Catalyst."
		},
		"pun0" : {
			"text" : "You slowly start seeing scrolling text. Spooky."
		},
		"pun1" : {
			"text" : "Suddenly, nothing of particular interest happened."
		},
		"pun2" : {
			"text" : "Hm, you wanna hear a joke about paper? It's tearable."
		},
		"pun3" : {
			"text" : "If you're enjoying the game consider supporting me \\('_' )."
		},
		"pun4" : {
			"text" : "Suddenly, nothing of particular interest happened."
		},
		"pun5" : {
			"text" : "No, mayonnaise won't ever become one of Elements. Do NOT write songs about it."
		},
		"pun6" : {
			"text" : 
				"Did you notice puns are getting incrementally more funny each time you hear them?"+
				"                                                                                           "+
				"Did you notice puns are getting incrementally more funny each time you hear them?"+
				"                                                                                           "+
				"Did you notice puns are getting incrementally more funny each time you hear them?"
		},
		"pun7" : {
			"text" : "PundexOutOfBounds - commence charging my PunReInator."
		}
	},
	
	"addLore" : function(loreId) {
		var messageLines = lore.loreMessages[loreId].text.split('\n');
		dynamicData.lore.messages.push("");
		for(var i=0;i<messageLines.length;i++) {
			dynamicData.lore.messages.push(messageLines[i]);
		}
		dynamicData.lore.maxScroll += 20*(1+messageLines.length);
		dynamicData.tabStatus[2].highlight = true;
	},
	"activatePopup" : function(popupId) {
		dynamicData.popupActive = popupId;
		if(lore.popupMessages[popupId].changeTab) {
			tempData.activeTab = lore.popupMessages[popupId].changeTab;
		}
	},
	"disablePopup" : function() {
		dynamicData.popupActive = null;
	},
	"addBannerMessage" : function(bannerId) {
		if(tempData.currentBanner) {
			tempData.nextBanners.push(bannerId);
		} else {
			tempData.currentBanner = lore.bannerMessages[bannerId];
		}
	},
	"bannerScroll" : function(ctx) {
		tempData.currentBannerPosition -= tempData.bannerSpeed;
		if(!tempData.currentBanner.bannerLength) {
			tempData.currentBanner.bannerLength = estimateBannerLength(tempData.currentBanner.text,ctx);
		}
		
		if(tempData.currentBanner.bannerLength + tempData.currentBannerPosition < 120) {
			tempData.currentBannerPosition = 780;
			if(tempData.nextBanners.length > 0) {
				tempData.currentBanner = lore.bannerMessages[tempData.nextBanners.shift()];
			} else {
				tempData.currentBanner = null;
			}
		}
	},
	"idleBanner" : function() {
		if(lore.bannerMessages["pun"+dynamicData.punCounter]) {
			lore.addBannerMessage("pun"+dynamicData.punCounter++);
		} else {
			dynamicData.punCounter = 0;
			lore.addBannerMessage("pun"+dynamicData.punCounter++);
		}
	}
}
